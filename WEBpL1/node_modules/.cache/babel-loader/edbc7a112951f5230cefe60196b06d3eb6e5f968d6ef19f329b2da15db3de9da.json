{"ast":null,"code":"/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * \n * @emails oncall+draft_js\n */\n'use strict';\n\nvar _knownListItemDepthCl;\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n  return target;\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nvar CharacterMetadata = require(\"./CharacterMetadata\");\nvar ContentBlock = require(\"./ContentBlock\");\nvar ContentBlockNode = require(\"./ContentBlockNode\");\nvar DefaultDraftBlockRenderMap = require(\"./DefaultDraftBlockRenderMap\");\nvar DraftEntity = require(\"./DraftEntity\");\nvar URI = require(\"fbjs/lib/URI\");\nvar cx = require(\"fbjs/lib/cx\");\nvar generateRandomKey = require(\"./generateRandomKey\");\nvar getSafeBodyFromHTML = require(\"./getSafeBodyFromHTML\");\nvar gkx = require(\"./gkx\");\nvar _require = require(\"immutable\"),\n  List = _require.List,\n  Map = _require.Map,\n  OrderedSet = _require.OrderedSet;\nvar isHTMLAnchorElement = require(\"./isHTMLAnchorElement\");\nvar isHTMLBRElement = require(\"./isHTMLBRElement\");\nvar isHTMLElement = require(\"./isHTMLElement\");\nvar isHTMLImageElement = require(\"./isHTMLImageElement\");\nvar experimentalTreeDataSupport = gkx('draft_tree_data_support');\nvar NBSP = '&nbsp;';\nvar SPACE = ' '; // used for replacing characters in HTML\n\nvar REGEX_CR = new RegExp('\\r', 'g');\nvar REGEX_LF = new RegExp('\\n', 'g');\nvar REGEX_LEADING_LF = new RegExp('^\\n', 'g');\nvar REGEX_NBSP = new RegExp(NBSP, 'g');\nvar REGEX_CARRIAGE = new RegExp('&#13;?', 'g');\nvar REGEX_ZWS = new RegExp('&#8203;?', 'g'); // https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight\n\nvar boldValues = ['bold', 'bolder', '500', '600', '700', '800', '900'];\nvar notBoldValues = ['light', 'lighter', 'normal', '100', '200', '300', '400'];\nvar anchorAttr = ['className', 'href', 'rel', 'target', 'title'];\nvar imgAttr = ['alt', 'className', 'height', 'src', 'width'];\nvar knownListItemDepthClasses = (_knownListItemDepthCl = {}, _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth0'), 0), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth1'), 1), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth2'), 2), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth3'), 3), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth4'), 4), _knownListItemDepthCl);\nvar HTMLTagToRawInlineStyleMap = Map({\n  b: 'BOLD',\n  code: 'CODE',\n  del: 'STRIKETHROUGH',\n  em: 'ITALIC',\n  i: 'ITALIC',\n  s: 'STRIKETHROUGH',\n  strike: 'STRIKETHROUGH',\n  strong: 'BOLD',\n  u: 'UNDERLINE',\n  mark: 'HIGHLIGHT'\n});\n\n/**\n * Build a mapping from HTML tags to draftjs block types\n * out of a BlockRenderMap.\n *\n * The BlockTypeMap for the default BlockRenderMap looks like this:\n *   Map({\n *     h1: 'header-one',\n *     h2: 'header-two',\n *     h3: 'header-three',\n *     h4: 'header-four',\n *     h5: 'header-five',\n *     h6: 'header-six',\n *     blockquote: 'blockquote',\n *     figure: 'atomic',\n *     pre: ['code-block'],\n *     div: 'unstyled',\n *     p: 'unstyled',\n *     li: ['ordered-list-item', 'unordered-list-item'],\n *   })\n */\nvar buildBlockTypeMap = function buildBlockTypeMap(blockRenderMap) {\n  var blockTypeMap = {};\n  blockRenderMap.mapKeys(function (blockType, desc) {\n    var elements = [desc.element];\n    if (desc.aliasedElements !== undefined) {\n      elements.push.apply(elements, desc.aliasedElements);\n    }\n    elements.forEach(function (element) {\n      if (blockTypeMap[element] === undefined) {\n        blockTypeMap[element] = blockType;\n      } else if (typeof blockTypeMap[element] === 'string') {\n        blockTypeMap[element] = [blockTypeMap[element], blockType];\n      } else {\n        blockTypeMap[element].push(blockType);\n      }\n    });\n  });\n  return Map(blockTypeMap);\n};\nvar detectInlineStyle = function detectInlineStyle(node) {\n  if (isHTMLElement(node)) {\n    var element = node; // Currently only used to detect preformatted inline code\n\n    if (element.style.fontFamily.includes('monospace')) {\n      return 'CODE';\n    }\n  }\n  return null;\n};\n/**\n * If we're pasting from one DraftEditor to another we can check to see if\n * existing list item depth classes are being used and preserve this style\n */\n\nvar getListItemDepth = function getListItemDepth(node) {\n  var depth = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  Object.keys(knownListItemDepthClasses).some(function (depthClass) {\n    if (node.classList.contains(depthClass)) {\n      depth = knownListItemDepthClasses[depthClass];\n    }\n  });\n  return depth;\n};\n/**\n * Return true if the provided HTML Element can be used to build a\n * Draftjs-compatible link.\n */\n\nvar isValidAnchor = function isValidAnchor(node) {\n  if (!isHTMLAnchorElement(node)) {\n    return false;\n  }\n  var anchorNode = node;\n  if (!anchorNode.href || anchorNode.protocol !== 'http:' && anchorNode.protocol !== 'https:' && anchorNode.protocol !== 'mailto:' && anchorNode.protocol !== 'tel:') {\n    return false;\n  }\n  try {\n    // Just checking whether we can actually create a URI\n    var _ = new URI(anchorNode.href);\n    return true; // We need our catch statements to have arguments, else\n    // UglifyJS (which we use for our OSS builds) will crash.\n    // eslint-disable-next-line fb-www/no-unused-catch-bindings\n  } catch (_) {\n    return false;\n  }\n};\n/**\n * Return true if the provided HTML Element can be used to build a\n * Draftjs-compatible image.\n */\n\nvar isValidImage = function isValidImage(node) {\n  if (!isHTMLImageElement(node)) {\n    return false;\n  }\n  var imageNode = node;\n  return !!(imageNode.attributes.getNamedItem('src') && imageNode.attributes.getNamedItem('src').value);\n};\n/**\n * Try to guess the inline style of an HTML element based on its css\n * styles (font-weight, font-style and text-decoration).\n */\n\nvar styleFromNodeAttributes = function styleFromNodeAttributes(node, style) {\n  if (!isHTMLElement(node)) {\n    return style;\n  }\n  var htmlElement = node;\n  var fontWeight = htmlElement.style.fontWeight;\n  var fontStyle = htmlElement.style.fontStyle;\n  var textDecoration = htmlElement.style.textDecoration;\n  return style.withMutations(function (style) {\n    if (boldValues.indexOf(fontWeight) >= 0) {\n      style.add('BOLD');\n    } else if (notBoldValues.indexOf(fontWeight) >= 0) {\n      style.remove('BOLD');\n    }\n    if (fontStyle === 'italic') {\n      style.add('ITALIC');\n    } else if (fontStyle === 'normal') {\n      style.remove('ITALIC');\n    }\n    if (textDecoration === 'underline') {\n      style.add('UNDERLINE');\n    }\n    if (textDecoration === 'line-through') {\n      style.add('STRIKETHROUGH');\n    }\n    if (textDecoration === 'none') {\n      style.remove('UNDERLINE');\n      style.remove('STRIKETHROUGH');\n    }\n  });\n};\n/**\n * Determine if a nodeName is a list type, 'ul' or 'ol'\n */\n\nvar isListNode = function isListNode(nodeName) {\n  return nodeName === 'ul' || nodeName === 'ol';\n};\n/**\n *  ContentBlockConfig is a mutable data structure that holds all\n *  the information required to build a ContentBlock and an array of\n *  all the child nodes (childConfigs).\n *  It is being used a temporary data structure by the\n *  ContentBlocksBuilder class.\n */\n\n/**\n * ContentBlocksBuilder builds a list of ContentBlocks and an Entity Map\n * out of one (or several) HTMLElement(s).\n *\n * The algorithm has two passes: first it builds a tree of ContentBlockConfigs\n * by walking through the HTML nodes and their children, then it walks the\n * ContentBlockConfigs tree to compute parents/siblings and create\n * the actual ContentBlocks.\n *\n * Typical usage is:\n *     new ContentBlocksBuilder()\n *        .addDOMNode(someHTMLNode)\n *        .addDOMNode(someOtherHTMLNode)\n *       .getContentBlocks();\n *\n */\nvar ContentBlocksBuilder = /*#__PURE__*/function () {\n  // Most of the method in the class depend on the state of the content builder\n  // (i.e. currentBlockType, currentDepth, currentEntity etc.). Though it may\n  // be confusing at first, it made the code simpler than the alternative which\n  // is to pass those values around in every call.\n  // The following attributes are used to accumulate text and styles\n  // as we are walking the HTML node tree.\n  // Describes the future ContentState as a tree of content blocks\n  // The content blocks generated from the blockConfigs\n  // Entity map use to store links and images found in the HTML nodes\n  // Map HTML tags to draftjs block types and disambiguation function\n  function ContentBlocksBuilder(blockTypeMap, disambiguate) {\n    _defineProperty(this, \"characterList\", List());\n    _defineProperty(this, \"currentBlockType\", 'unstyled');\n    _defineProperty(this, \"currentDepth\", 0);\n    _defineProperty(this, \"currentEntity\", null);\n    _defineProperty(this, \"currentText\", '');\n    _defineProperty(this, \"wrapper\", null);\n    _defineProperty(this, \"blockConfigs\", []);\n    _defineProperty(this, \"contentBlocks\", []);\n    _defineProperty(this, \"entityMap\", DraftEntity);\n    _defineProperty(this, \"blockTypeMap\", void 0);\n    _defineProperty(this, \"disambiguate\", void 0);\n    this.clear();\n    this.blockTypeMap = blockTypeMap;\n    this.disambiguate = disambiguate;\n  }\n  /**\n   * Clear the internal state of the ContentBlocksBuilder\n   */\n\n  var _proto = ContentBlocksBuilder.prototype;\n  _proto.clear = function clear() {\n    this.characterList = List();\n    this.blockConfigs = [];\n    this.currentBlockType = 'unstyled';\n    this.currentDepth = 0;\n    this.currentEntity = null;\n    this.currentText = '';\n    this.entityMap = DraftEntity;\n    this.wrapper = null;\n    this.contentBlocks = [];\n  }\n  /**\n   * Add an HTMLElement to the ContentBlocksBuilder\n   */;\n\n  _proto.addDOMNode = function addDOMNode(node) {\n    var _this$blockConfigs;\n    this.contentBlocks = [];\n    this.currentDepth = 0; // Converts the HTML node to block config\n\n    (_this$blockConfigs = this.blockConfigs).push.apply(_this$blockConfigs, this._toBlockConfigs([node], OrderedSet())); // There might be some left over text in the builder's\n    // internal state, if so make a ContentBlock out of it.\n\n    this._trimCurrentText();\n    if (this.currentText !== '') {\n      this.blockConfigs.push(this._makeBlockConfig());\n    } // for chaining\n\n    return this;\n  }\n  /**\n   * Return the ContentBlocks and the EntityMap that corresponds\n   * to the previously added HTML nodes.\n   */;\n\n  _proto.getContentBlocks = function getContentBlocks() {\n    if (this.contentBlocks.length === 0) {\n      if (experimentalTreeDataSupport) {\n        this._toContentBlocks(this.blockConfigs);\n      } else {\n        this._toFlatContentBlocks(this.blockConfigs);\n      }\n    }\n    return {\n      contentBlocks: this.contentBlocks,\n      entityMap: this.entityMap\n    };\n  } // ***********************************WARNING******************************\n  // The methods below this line are private - don't call them directly.\n\n  /**\n   * Generate a new ContentBlockConfig out of the current internal state\n   * of the builder, then clears the internal state.\n   */;\n\n  _proto._makeBlockConfig = function _makeBlockConfig() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var key = config.key || generateRandomKey();\n    var block = _objectSpread({\n      key: key,\n      type: this.currentBlockType,\n      text: this.currentText,\n      characterList: this.characterList,\n      depth: this.currentDepth,\n      parent: null,\n      children: List(),\n      prevSibling: null,\n      nextSibling: null,\n      childConfigs: []\n    }, config);\n    this.characterList = List();\n    this.currentBlockType = 'unstyled';\n    this.currentText = '';\n    return block;\n  }\n  /**\n   * Converts an array of HTML elements to a multi-root tree of content\n   * block configs. Some text content may be left in the builders internal\n   * state to enable chaining sucessive calls.\n   */;\n\n  _proto._toBlockConfigs = function _toBlockConfigs(nodes, style) {\n    var blockConfigs = [];\n    for (var i = 0; i < nodes.length; i++) {\n      var node = nodes[i];\n      var nodeName = node.nodeName.toLowerCase();\n      if (nodeName === 'body' || isListNode(nodeName)) {\n        // body, ol and ul are 'block' type nodes so create a block config\n        // with the text accumulated so far (if any)\n        this._trimCurrentText();\n        if (this.currentText !== '') {\n          blockConfigs.push(this._makeBlockConfig());\n        } // body, ol and ul nodes are ignored, but their children are inlined in\n        // the parent block config.\n\n        var wasCurrentDepth = this.currentDepth;\n        var wasWrapper = this.wrapper;\n        if (isListNode(nodeName)) {\n          this.wrapper = nodeName;\n          if (isListNode(wasWrapper)) {\n            this.currentDepth++;\n          }\n        }\n        blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), style));\n        this.currentDepth = wasCurrentDepth;\n        this.wrapper = wasWrapper;\n        continue;\n      }\n      var blockType = this.blockTypeMap.get(nodeName);\n      if (blockType !== undefined) {\n        // 'block' type node means we need to create a block config\n        // with the text accumulated so far (if any)\n        this._trimCurrentText();\n        if (this.currentText !== '') {\n          blockConfigs.push(this._makeBlockConfig());\n        }\n        var _wasCurrentDepth = this.currentDepth;\n        var _wasWrapper = this.wrapper;\n        this.wrapper = nodeName === 'pre' ? 'pre' : this.wrapper;\n        if (typeof blockType !== 'string') {\n          blockType = this.disambiguate(nodeName, this.wrapper) || blockType[0] || 'unstyled';\n        }\n        if (!experimentalTreeDataSupport && isHTMLElement(node) && (blockType === 'unordered-list-item' || blockType === 'ordered-list-item')) {\n          var htmlElement = node;\n          this.currentDepth = getListItemDepth(htmlElement, this.currentDepth);\n        }\n        var key = generateRandomKey();\n        var childConfigs = this._toBlockConfigs(Array.from(node.childNodes), style);\n        this._trimCurrentText();\n        blockConfigs.push(this._makeBlockConfig({\n          key: key,\n          childConfigs: childConfigs,\n          type: blockType\n        }));\n        this.currentDepth = _wasCurrentDepth;\n        this.wrapper = _wasWrapper;\n        continue;\n      }\n      if (nodeName === '#text') {\n        this._addTextNode(node, style);\n        continue;\n      }\n      if (nodeName === 'br') {\n        this._addBreakNode(node, style);\n        continue;\n      }\n      if (isValidImage(node)) {\n        this._addImgNode(node, style);\n        continue;\n      }\n      if (isValidAnchor(node)) {\n        this._addAnchorNode(node, blockConfigs, style);\n        continue;\n      }\n      var newStyle = style;\n      if (HTMLTagToRawInlineStyleMap.has(nodeName)) {\n        newStyle = newStyle.add(HTMLTagToRawInlineStyleMap.get(nodeName));\n      }\n      newStyle = styleFromNodeAttributes(node, newStyle);\n      var inlineStyle = detectInlineStyle(node);\n      if (inlineStyle != null) {\n        newStyle = newStyle.add(inlineStyle);\n      }\n      blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), newStyle));\n    }\n    return blockConfigs;\n  }\n  /**\n   * Append a string of text to the internal buffer.\n   */;\n\n  _proto._appendText = function _appendText(text, style) {\n    var _this$characterList;\n    this.currentText += text;\n    var characterMetadata = CharacterMetadata.create({\n      style: style,\n      entity: this.currentEntity\n    });\n    this.characterList = (_this$characterList = this.characterList).push.apply(_this$characterList, Array(text.length).fill(characterMetadata));\n  }\n  /**\n   * Trim the text in the internal buffer.\n   */;\n\n  _proto._trimCurrentText = function _trimCurrentText() {\n    var l = this.currentText.length;\n    var begin = l - this.currentText.trimLeft().length;\n    var end = this.currentText.trimRight().length; // We should not trim whitespaces for which an entity is defined.\n\n    var entity = this.characterList.findEntry(function (characterMetadata) {\n      return characterMetadata.getEntity() !== null;\n    });\n    begin = entity !== undefined ? Math.min(begin, entity[0]) : begin;\n    entity = this.characterList.reverse().findEntry(function (characterMetadata) {\n      return characterMetadata.getEntity() !== null;\n    });\n    end = entity !== undefined ? Math.max(end, l - entity[0]) : end;\n    if (begin > end) {\n      this.currentText = '';\n      this.characterList = List();\n    } else {\n      this.currentText = this.currentText.slice(begin, end);\n      this.characterList = this.characterList.slice(begin, end);\n    }\n  }\n  /**\n   * Add the content of an HTML text node to the internal state\n   */;\n\n  _proto._addTextNode = function _addTextNode(node, style) {\n    var text = node.textContent;\n    var trimmedText = text.trim(); // If we are not in a pre block and the trimmed content is empty,\n    // normalize to a single space.\n\n    if (trimmedText === '' && this.wrapper !== 'pre') {\n      text = ' ';\n    }\n    if (this.wrapper !== 'pre') {\n      // Trim leading line feed, which is invisible in HTML\n      text = text.replace(REGEX_LEADING_LF, ''); // Can't use empty string because MSWord\n\n      text = text.replace(REGEX_LF, SPACE);\n    }\n    this._appendText(text, style);\n  };\n  _proto._addBreakNode = function _addBreakNode(node, style) {\n    if (!isHTMLBRElement(node)) {\n      return;\n    }\n    this._appendText('\\n', style);\n  }\n  /**\n   * Add the content of an HTML img node to the internal state\n   */;\n\n  _proto._addImgNode = function _addImgNode(node, style) {\n    if (!isHTMLImageElement(node)) {\n      return;\n    }\n    var image = node;\n    var entityConfig = {};\n    imgAttr.forEach(function (attr) {\n      var imageAttribute = image.getAttribute(attr);\n      if (imageAttribute) {\n        entityConfig[attr] = imageAttribute;\n      }\n    }); // TODO: T15530363 update this when we remove DraftEntity entirely\n\n    this.currentEntity = this.entityMap.__create('IMAGE', 'IMMUTABLE', entityConfig); // The child text node cannot just have a space or return as content (since\n    // we strip those out), unless the image is for presentation only.\n    // See https://github.com/facebook/draft-js/issues/231 for some context.\n\n    if (gkx('draftjs_fix_paste_for_img')) {\n      if (image.getAttribute('role') !== 'presentation') {\n        this._appendText(\"\\uD83D\\uDCF7\", style);\n      }\n    } else {\n      this._appendText(\"\\uD83D\\uDCF7\", style);\n    }\n    this.currentEntity = null;\n  }\n  /**\n   * Add the content of an HTML 'a' node to the internal state. Child nodes\n   * (if any) are converted to Block Configs and appended to the provided\n   * blockConfig array.\n   */;\n\n  _proto._addAnchorNode = function _addAnchorNode(node, blockConfigs, style) {\n    // The check has already been made by isValidAnchor but\n    // we have to do it again to keep flow happy.\n    if (!isHTMLAnchorElement(node)) {\n      return;\n    }\n    var anchor = node;\n    var entityConfig = {};\n    anchorAttr.forEach(function (attr) {\n      var anchorAttribute = anchor.getAttribute(attr);\n      if (anchorAttribute) {\n        entityConfig[attr] = anchorAttribute;\n      }\n    });\n    entityConfig.url = new URI(anchor.href).toString(); // TODO: T15530363 update this when we remove DraftEntity completely\n\n    this.currentEntity = this.entityMap.__create('LINK', 'MUTABLE', entityConfig || {});\n    blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), style));\n    this.currentEntity = null;\n  }\n  /**\n   * Walk the BlockConfig tree, compute parent/children/siblings,\n   * and generate the corresponding ContentBlockNode\n   */;\n\n  _proto._toContentBlocks = function _toContentBlocks(blockConfigs) {\n    var parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var l = blockConfigs.length - 1;\n    for (var i = 0; i <= l; i++) {\n      var config = blockConfigs[i];\n      config.parent = parent;\n      config.prevSibling = i > 0 ? blockConfigs[i - 1].key : null;\n      config.nextSibling = i < l ? blockConfigs[i + 1].key : null;\n      config.children = List(config.childConfigs.map(function (child) {\n        return child.key;\n      }));\n      this.contentBlocks.push(new ContentBlockNode(_objectSpread({}, config)));\n      this._toContentBlocks(config.childConfigs, config.key);\n    }\n  }\n  /**\n   * Remove 'useless' container nodes from the block config hierarchy, by\n   * replacing them with their children.\n   */;\n\n  _proto._hoistContainersInBlockConfigs = function _hoistContainersInBlockConfigs(blockConfigs) {\n    var _this = this;\n    var hoisted = List(blockConfigs).flatMap(function (blockConfig) {\n      // Don't mess with useful blocks\n      if (blockConfig.type !== 'unstyled' || blockConfig.text !== '') {\n        return [blockConfig];\n      }\n      return _this._hoistContainersInBlockConfigs(blockConfig.childConfigs);\n    });\n    return hoisted;\n  } // ***********************************************************************\n  // The two methods below are used for backward compatibility when\n  // experimentalTreeDataSupport is disabled.\n\n  /**\n   * Same as _toContentBlocks but replaces nested blocks by their\n   * text content.\n   */;\n\n  _proto._toFlatContentBlocks = function _toFlatContentBlocks(blockConfigs) {\n    var _this2 = this;\n    var cleanConfigs = this._hoistContainersInBlockConfigs(blockConfigs);\n    cleanConfigs.forEach(function (config) {\n      var _this2$_extractTextFr = _this2._extractTextFromBlockConfigs(config.childConfigs),\n        text = _this2$_extractTextFr.text,\n        characterList = _this2$_extractTextFr.characterList;\n      _this2.contentBlocks.push(new ContentBlock(_objectSpread({}, config, {\n        text: config.text + text,\n        characterList: config.characterList.concat(characterList)\n      })));\n    });\n  }\n  /**\n   * Extract the text and the associated inline styles form an\n   * array of content block configs.\n   */;\n\n  _proto._extractTextFromBlockConfigs = function _extractTextFromBlockConfigs(blockConfigs) {\n    var l = blockConfigs.length - 1;\n    var text = '';\n    var characterList = List();\n    for (var i = 0; i <= l; i++) {\n      var config = blockConfigs[i];\n      text += config.text;\n      characterList = characterList.concat(config.characterList);\n      if (text !== '' && config.type !== 'unstyled') {\n        text += '\\n';\n        characterList = characterList.push(characterList.last());\n      }\n      var children = this._extractTextFromBlockConfigs(config.childConfigs);\n      text += children.text;\n      characterList = characterList.concat(children.characterList);\n    }\n    return {\n      text: text,\n      characterList: characterList\n    };\n  };\n  return ContentBlocksBuilder;\n}();\n/**\n * Converts an HTML string to an array of ContentBlocks and an EntityMap\n * suitable to initialize the internal state of a Draftjs component.\n */\n\nvar convertFromHTMLToContentBlocks = function convertFromHTMLToContentBlocks(html) {\n  var DOMBuilder = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getSafeBodyFromHTML;\n  var blockRenderMap = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : DefaultDraftBlockRenderMap;\n  // Be ABSOLUTELY SURE that the dom builder you pass here won't execute\n  // arbitrary code in whatever environment you're running this in. For an\n  // example of how we try to do this in-browser, see getSafeBodyFromHTML.\n  // Remove funky characters from the HTML string\n  html = html.trim().replace(REGEX_CR, '').replace(REGEX_NBSP, SPACE).replace(REGEX_CARRIAGE, '').replace(REGEX_ZWS, ''); // Build a DOM tree out of the HTML string\n\n  var safeBody = DOMBuilder(html);\n  if (!safeBody) {\n    return null;\n  } // Build a BlockTypeMap out of the BlockRenderMap\n\n  var blockTypeMap = buildBlockTypeMap(blockRenderMap); // Select the proper block type for the cases where the blockRenderMap\n  // uses multiple block types for the same html tag.\n\n  var disambiguate = function disambiguate(tag, wrapper) {\n    if (tag === 'li') {\n      return wrapper === 'ol' ? 'ordered-list-item' : 'unordered-list-item';\n    }\n    return null;\n  };\n  return new ContentBlocksBuilder(blockTypeMap, disambiguate).addDOMNode(safeBody).getContentBlocks();\n};\nmodule.exports = convertFromHTMLToContentBlocks;","map":{"version":3,"names":["_knownListItemDepthCl","_objectSpread","target","i","arguments","length","source","ownKeys","Object","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","value","defineProperty","configurable","writable","CharacterMetadata","require","ContentBlock","ContentBlockNode","DefaultDraftBlockRenderMap","DraftEntity","URI","cx","generateRandomKey","getSafeBodyFromHTML","gkx","_require","List","Map","OrderedSet","isHTMLAnchorElement","isHTMLBRElement","isHTMLElement","isHTMLImageElement","experimentalTreeDataSupport","NBSP","SPACE","REGEX_CR","RegExp","REGEX_LF","REGEX_LEADING_LF","REGEX_NBSP","REGEX_CARRIAGE","REGEX_ZWS","boldValues","notBoldValues","anchorAttr","imgAttr","knownListItemDepthClasses","HTMLTagToRawInlineStyleMap","b","code","del","em","s","strike","strong","u","mark","buildBlockTypeMap","blockRenderMap","blockTypeMap","mapKeys","blockType","desc","elements","element","aliasedElements","undefined","push","apply","detectInlineStyle","node","style","fontFamily","includes","getListItemDepth","depth","some","depthClass","classList","contains","isValidAnchor","anchorNode","href","protocol","_","isValidImage","imageNode","attributes","getNamedItem","styleFromNodeAttributes","htmlElement","fontWeight","fontStyle","textDecoration","withMutations","indexOf","add","remove","isListNode","nodeName","ContentBlocksBuilder","disambiguate","clear","_proto","prototype","characterList","blockConfigs","currentBlockType","currentDepth","currentEntity","currentText","entityMap","wrapper","contentBlocks","addDOMNode","_this$blockConfigs","_toBlockConfigs","_trimCurrentText","_makeBlockConfig","getContentBlocks","_toContentBlocks","_toFlatContentBlocks","config","block","type","text","parent","children","prevSibling","nextSibling","childConfigs","nodes","toLowerCase","wasCurrentDepth","wasWrapper","Array","from","childNodes","get","_wasCurrentDepth","_wasWrapper","_addTextNode","_addBreakNode","_addImgNode","_addAnchorNode","newStyle","has","inlineStyle","_appendText","_this$characterList","characterMetadata","create","entity","fill","l","begin","trimLeft","end","trimRight","findEntry","getEntity","Math","min","reverse","max","slice","textContent","trimmedText","trim","replace","image","entityConfig","attr","imageAttribute","getAttribute","__create","anchor","anchorAttribute","url","toString","map","child","_hoistContainersInBlockConfigs","_this","hoisted","flatMap","blockConfig","_this2","cleanConfigs","_this2$_extractTextFr","_extractTextFromBlockConfigs","last","convertFromHTMLToContentBlocks","html","DOMBuilder","safeBody","tag","module","exports"],"sources":["C:/Users/Teh_phoENIX/source/repos/WEBp/WEBpL1/node_modules/draft-js/lib/convertFromHTMLToContentBlocks.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * \n * @emails oncall+draft_js\n */\n'use strict';\n\nvar _knownListItemDepthCl;\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar CharacterMetadata = require(\"./CharacterMetadata\");\n\nvar ContentBlock = require(\"./ContentBlock\");\n\nvar ContentBlockNode = require(\"./ContentBlockNode\");\n\nvar DefaultDraftBlockRenderMap = require(\"./DefaultDraftBlockRenderMap\");\n\nvar DraftEntity = require(\"./DraftEntity\");\n\nvar URI = require(\"fbjs/lib/URI\");\n\nvar cx = require(\"fbjs/lib/cx\");\n\nvar generateRandomKey = require(\"./generateRandomKey\");\n\nvar getSafeBodyFromHTML = require(\"./getSafeBodyFromHTML\");\n\nvar gkx = require(\"./gkx\");\n\nvar _require = require(\"immutable\"),\n    List = _require.List,\n    Map = _require.Map,\n    OrderedSet = _require.OrderedSet;\n\nvar isHTMLAnchorElement = require(\"./isHTMLAnchorElement\");\n\nvar isHTMLBRElement = require(\"./isHTMLBRElement\");\n\nvar isHTMLElement = require(\"./isHTMLElement\");\n\nvar isHTMLImageElement = require(\"./isHTMLImageElement\");\n\nvar experimentalTreeDataSupport = gkx('draft_tree_data_support');\nvar NBSP = '&nbsp;';\nvar SPACE = ' '; // used for replacing characters in HTML\n\nvar REGEX_CR = new RegExp('\\r', 'g');\nvar REGEX_LF = new RegExp('\\n', 'g');\nvar REGEX_LEADING_LF = new RegExp('^\\n', 'g');\nvar REGEX_NBSP = new RegExp(NBSP, 'g');\nvar REGEX_CARRIAGE = new RegExp('&#13;?', 'g');\nvar REGEX_ZWS = new RegExp('&#8203;?', 'g'); // https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight\n\nvar boldValues = ['bold', 'bolder', '500', '600', '700', '800', '900'];\nvar notBoldValues = ['light', 'lighter', 'normal', '100', '200', '300', '400'];\nvar anchorAttr = ['className', 'href', 'rel', 'target', 'title'];\nvar imgAttr = ['alt', 'className', 'height', 'src', 'width'];\nvar knownListItemDepthClasses = (_knownListItemDepthCl = {}, _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth0'), 0), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth1'), 1), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth2'), 2), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth3'), 3), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth4'), 4), _knownListItemDepthCl);\nvar HTMLTagToRawInlineStyleMap = Map({\n  b: 'BOLD',\n  code: 'CODE',\n  del: 'STRIKETHROUGH',\n  em: 'ITALIC',\n  i: 'ITALIC',\n  s: 'STRIKETHROUGH',\n  strike: 'STRIKETHROUGH',\n  strong: 'BOLD',\n  u: 'UNDERLINE',\n  mark: 'HIGHLIGHT'\n});\n\n/**\n * Build a mapping from HTML tags to draftjs block types\n * out of a BlockRenderMap.\n *\n * The BlockTypeMap for the default BlockRenderMap looks like this:\n *   Map({\n *     h1: 'header-one',\n *     h2: 'header-two',\n *     h3: 'header-three',\n *     h4: 'header-four',\n *     h5: 'header-five',\n *     h6: 'header-six',\n *     blockquote: 'blockquote',\n *     figure: 'atomic',\n *     pre: ['code-block'],\n *     div: 'unstyled',\n *     p: 'unstyled',\n *     li: ['ordered-list-item', 'unordered-list-item'],\n *   })\n */\nvar buildBlockTypeMap = function buildBlockTypeMap(blockRenderMap) {\n  var blockTypeMap = {};\n  blockRenderMap.mapKeys(function (blockType, desc) {\n    var elements = [desc.element];\n\n    if (desc.aliasedElements !== undefined) {\n      elements.push.apply(elements, desc.aliasedElements);\n    }\n\n    elements.forEach(function (element) {\n      if (blockTypeMap[element] === undefined) {\n        blockTypeMap[element] = blockType;\n      } else if (typeof blockTypeMap[element] === 'string') {\n        blockTypeMap[element] = [blockTypeMap[element], blockType];\n      } else {\n        blockTypeMap[element].push(blockType);\n      }\n    });\n  });\n  return Map(blockTypeMap);\n};\n\nvar detectInlineStyle = function detectInlineStyle(node) {\n  if (isHTMLElement(node)) {\n    var element = node; // Currently only used to detect preformatted inline code\n\n    if (element.style.fontFamily.includes('monospace')) {\n      return 'CODE';\n    }\n  }\n\n  return null;\n};\n/**\n * If we're pasting from one DraftEditor to another we can check to see if\n * existing list item depth classes are being used and preserve this style\n */\n\n\nvar getListItemDepth = function getListItemDepth(node) {\n  var depth = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  Object.keys(knownListItemDepthClasses).some(function (depthClass) {\n    if (node.classList.contains(depthClass)) {\n      depth = knownListItemDepthClasses[depthClass];\n    }\n  });\n  return depth;\n};\n/**\n * Return true if the provided HTML Element can be used to build a\n * Draftjs-compatible link.\n */\n\n\nvar isValidAnchor = function isValidAnchor(node) {\n  if (!isHTMLAnchorElement(node)) {\n    return false;\n  }\n\n  var anchorNode = node;\n\n  if (!anchorNode.href || anchorNode.protocol !== 'http:' && anchorNode.protocol !== 'https:' && anchorNode.protocol !== 'mailto:' && anchorNode.protocol !== 'tel:') {\n    return false;\n  }\n\n  try {\n    // Just checking whether we can actually create a URI\n    var _ = new URI(anchorNode.href);\n\n    return true; // We need our catch statements to have arguments, else\n    // UglifyJS (which we use for our OSS builds) will crash.\n    // eslint-disable-next-line fb-www/no-unused-catch-bindings\n  } catch (_) {\n    return false;\n  }\n};\n/**\n * Return true if the provided HTML Element can be used to build a\n * Draftjs-compatible image.\n */\n\n\nvar isValidImage = function isValidImage(node) {\n  if (!isHTMLImageElement(node)) {\n    return false;\n  }\n\n  var imageNode = node;\n  return !!(imageNode.attributes.getNamedItem('src') && imageNode.attributes.getNamedItem('src').value);\n};\n/**\n * Try to guess the inline style of an HTML element based on its css\n * styles (font-weight, font-style and text-decoration).\n */\n\n\nvar styleFromNodeAttributes = function styleFromNodeAttributes(node, style) {\n  if (!isHTMLElement(node)) {\n    return style;\n  }\n\n  var htmlElement = node;\n  var fontWeight = htmlElement.style.fontWeight;\n  var fontStyle = htmlElement.style.fontStyle;\n  var textDecoration = htmlElement.style.textDecoration;\n  return style.withMutations(function (style) {\n    if (boldValues.indexOf(fontWeight) >= 0) {\n      style.add('BOLD');\n    } else if (notBoldValues.indexOf(fontWeight) >= 0) {\n      style.remove('BOLD');\n    }\n\n    if (fontStyle === 'italic') {\n      style.add('ITALIC');\n    } else if (fontStyle === 'normal') {\n      style.remove('ITALIC');\n    }\n\n    if (textDecoration === 'underline') {\n      style.add('UNDERLINE');\n    }\n\n    if (textDecoration === 'line-through') {\n      style.add('STRIKETHROUGH');\n    }\n\n    if (textDecoration === 'none') {\n      style.remove('UNDERLINE');\n      style.remove('STRIKETHROUGH');\n    }\n  });\n};\n/**\n * Determine if a nodeName is a list type, 'ul' or 'ol'\n */\n\n\nvar isListNode = function isListNode(nodeName) {\n  return nodeName === 'ul' || nodeName === 'ol';\n};\n/**\n *  ContentBlockConfig is a mutable data structure that holds all\n *  the information required to build a ContentBlock and an array of\n *  all the child nodes (childConfigs).\n *  It is being used a temporary data structure by the\n *  ContentBlocksBuilder class.\n */\n\n\n/**\n * ContentBlocksBuilder builds a list of ContentBlocks and an Entity Map\n * out of one (or several) HTMLElement(s).\n *\n * The algorithm has two passes: first it builds a tree of ContentBlockConfigs\n * by walking through the HTML nodes and their children, then it walks the\n * ContentBlockConfigs tree to compute parents/siblings and create\n * the actual ContentBlocks.\n *\n * Typical usage is:\n *     new ContentBlocksBuilder()\n *        .addDOMNode(someHTMLNode)\n *        .addDOMNode(someOtherHTMLNode)\n *       .getContentBlocks();\n *\n */\nvar ContentBlocksBuilder = /*#__PURE__*/function () {\n  // Most of the method in the class depend on the state of the content builder\n  // (i.e. currentBlockType, currentDepth, currentEntity etc.). Though it may\n  // be confusing at first, it made the code simpler than the alternative which\n  // is to pass those values around in every call.\n  // The following attributes are used to accumulate text and styles\n  // as we are walking the HTML node tree.\n  // Describes the future ContentState as a tree of content blocks\n  // The content blocks generated from the blockConfigs\n  // Entity map use to store links and images found in the HTML nodes\n  // Map HTML tags to draftjs block types and disambiguation function\n  function ContentBlocksBuilder(blockTypeMap, disambiguate) {\n    _defineProperty(this, \"characterList\", List());\n\n    _defineProperty(this, \"currentBlockType\", 'unstyled');\n\n    _defineProperty(this, \"currentDepth\", 0);\n\n    _defineProperty(this, \"currentEntity\", null);\n\n    _defineProperty(this, \"currentText\", '');\n\n    _defineProperty(this, \"wrapper\", null);\n\n    _defineProperty(this, \"blockConfigs\", []);\n\n    _defineProperty(this, \"contentBlocks\", []);\n\n    _defineProperty(this, \"entityMap\", DraftEntity);\n\n    _defineProperty(this, \"blockTypeMap\", void 0);\n\n    _defineProperty(this, \"disambiguate\", void 0);\n\n    this.clear();\n    this.blockTypeMap = blockTypeMap;\n    this.disambiguate = disambiguate;\n  }\n  /**\n   * Clear the internal state of the ContentBlocksBuilder\n   */\n\n\n  var _proto = ContentBlocksBuilder.prototype;\n\n  _proto.clear = function clear() {\n    this.characterList = List();\n    this.blockConfigs = [];\n    this.currentBlockType = 'unstyled';\n    this.currentDepth = 0;\n    this.currentEntity = null;\n    this.currentText = '';\n    this.entityMap = DraftEntity;\n    this.wrapper = null;\n    this.contentBlocks = [];\n  }\n  /**\n   * Add an HTMLElement to the ContentBlocksBuilder\n   */\n  ;\n\n  _proto.addDOMNode = function addDOMNode(node) {\n    var _this$blockConfigs;\n\n    this.contentBlocks = [];\n    this.currentDepth = 0; // Converts the HTML node to block config\n\n    (_this$blockConfigs = this.blockConfigs).push.apply(_this$blockConfigs, this._toBlockConfigs([node], OrderedSet())); // There might be some left over text in the builder's\n    // internal state, if so make a ContentBlock out of it.\n\n\n    this._trimCurrentText();\n\n    if (this.currentText !== '') {\n      this.blockConfigs.push(this._makeBlockConfig());\n    } // for chaining\n\n\n    return this;\n  }\n  /**\n   * Return the ContentBlocks and the EntityMap that corresponds\n   * to the previously added HTML nodes.\n   */\n  ;\n\n  _proto.getContentBlocks = function getContentBlocks() {\n    if (this.contentBlocks.length === 0) {\n      if (experimentalTreeDataSupport) {\n        this._toContentBlocks(this.blockConfigs);\n      } else {\n        this._toFlatContentBlocks(this.blockConfigs);\n      }\n    }\n\n    return {\n      contentBlocks: this.contentBlocks,\n      entityMap: this.entityMap\n    };\n  } // ***********************************WARNING******************************\n  // The methods below this line are private - don't call them directly.\n\n  /**\n   * Generate a new ContentBlockConfig out of the current internal state\n   * of the builder, then clears the internal state.\n   */\n  ;\n\n  _proto._makeBlockConfig = function _makeBlockConfig() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var key = config.key || generateRandomKey();\n\n    var block = _objectSpread({\n      key: key,\n      type: this.currentBlockType,\n      text: this.currentText,\n      characterList: this.characterList,\n      depth: this.currentDepth,\n      parent: null,\n      children: List(),\n      prevSibling: null,\n      nextSibling: null,\n      childConfigs: []\n    }, config);\n\n    this.characterList = List();\n    this.currentBlockType = 'unstyled';\n    this.currentText = '';\n    return block;\n  }\n  /**\n   * Converts an array of HTML elements to a multi-root tree of content\n   * block configs. Some text content may be left in the builders internal\n   * state to enable chaining sucessive calls.\n   */\n  ;\n\n  _proto._toBlockConfigs = function _toBlockConfigs(nodes, style) {\n    var blockConfigs = [];\n\n    for (var i = 0; i < nodes.length; i++) {\n      var node = nodes[i];\n      var nodeName = node.nodeName.toLowerCase();\n\n      if (nodeName === 'body' || isListNode(nodeName)) {\n        // body, ol and ul are 'block' type nodes so create a block config\n        // with the text accumulated so far (if any)\n        this._trimCurrentText();\n\n        if (this.currentText !== '') {\n          blockConfigs.push(this._makeBlockConfig());\n        } // body, ol and ul nodes are ignored, but their children are inlined in\n        // the parent block config.\n\n\n        var wasCurrentDepth = this.currentDepth;\n        var wasWrapper = this.wrapper;\n\n        if (isListNode(nodeName)) {\n          this.wrapper = nodeName;\n\n          if (isListNode(wasWrapper)) {\n            this.currentDepth++;\n          }\n        }\n\n        blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), style));\n        this.currentDepth = wasCurrentDepth;\n        this.wrapper = wasWrapper;\n        continue;\n      }\n\n      var blockType = this.blockTypeMap.get(nodeName);\n\n      if (blockType !== undefined) {\n        // 'block' type node means we need to create a block config\n        // with the text accumulated so far (if any)\n        this._trimCurrentText();\n\n        if (this.currentText !== '') {\n          blockConfigs.push(this._makeBlockConfig());\n        }\n\n        var _wasCurrentDepth = this.currentDepth;\n        var _wasWrapper = this.wrapper;\n        this.wrapper = nodeName === 'pre' ? 'pre' : this.wrapper;\n\n        if (typeof blockType !== 'string') {\n          blockType = this.disambiguate(nodeName, this.wrapper) || blockType[0] || 'unstyled';\n        }\n\n        if (!experimentalTreeDataSupport && isHTMLElement(node) && (blockType === 'unordered-list-item' || blockType === 'ordered-list-item')) {\n          var htmlElement = node;\n          this.currentDepth = getListItemDepth(htmlElement, this.currentDepth);\n        }\n\n        var key = generateRandomKey();\n\n        var childConfigs = this._toBlockConfigs(Array.from(node.childNodes), style);\n\n        this._trimCurrentText();\n\n        blockConfigs.push(this._makeBlockConfig({\n          key: key,\n          childConfigs: childConfigs,\n          type: blockType\n        }));\n        this.currentDepth = _wasCurrentDepth;\n        this.wrapper = _wasWrapper;\n        continue;\n      }\n\n      if (nodeName === '#text') {\n        this._addTextNode(node, style);\n\n        continue;\n      }\n\n      if (nodeName === 'br') {\n        this._addBreakNode(node, style);\n\n        continue;\n      }\n\n      if (isValidImage(node)) {\n        this._addImgNode(node, style);\n\n        continue;\n      }\n\n      if (isValidAnchor(node)) {\n        this._addAnchorNode(node, blockConfigs, style);\n\n        continue;\n      }\n\n      var newStyle = style;\n\n      if (HTMLTagToRawInlineStyleMap.has(nodeName)) {\n        newStyle = newStyle.add(HTMLTagToRawInlineStyleMap.get(nodeName));\n      }\n\n      newStyle = styleFromNodeAttributes(node, newStyle);\n      var inlineStyle = detectInlineStyle(node);\n\n      if (inlineStyle != null) {\n        newStyle = newStyle.add(inlineStyle);\n      }\n\n      blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), newStyle));\n    }\n\n    return blockConfigs;\n  }\n  /**\n   * Append a string of text to the internal buffer.\n   */\n  ;\n\n  _proto._appendText = function _appendText(text, style) {\n    var _this$characterList;\n\n    this.currentText += text;\n    var characterMetadata = CharacterMetadata.create({\n      style: style,\n      entity: this.currentEntity\n    });\n    this.characterList = (_this$characterList = this.characterList).push.apply(_this$characterList, Array(text.length).fill(characterMetadata));\n  }\n  /**\n   * Trim the text in the internal buffer.\n   */\n  ;\n\n  _proto._trimCurrentText = function _trimCurrentText() {\n    var l = this.currentText.length;\n    var begin = l - this.currentText.trimLeft().length;\n    var end = this.currentText.trimRight().length; // We should not trim whitespaces for which an entity is defined.\n\n    var entity = this.characterList.findEntry(function (characterMetadata) {\n      return characterMetadata.getEntity() !== null;\n    });\n    begin = entity !== undefined ? Math.min(begin, entity[0]) : begin;\n    entity = this.characterList.reverse().findEntry(function (characterMetadata) {\n      return characterMetadata.getEntity() !== null;\n    });\n    end = entity !== undefined ? Math.max(end, l - entity[0]) : end;\n\n    if (begin > end) {\n      this.currentText = '';\n      this.characterList = List();\n    } else {\n      this.currentText = this.currentText.slice(begin, end);\n      this.characterList = this.characterList.slice(begin, end);\n    }\n  }\n  /**\n   * Add the content of an HTML text node to the internal state\n   */\n  ;\n\n  _proto._addTextNode = function _addTextNode(node, style) {\n    var text = node.textContent;\n    var trimmedText = text.trim(); // If we are not in a pre block and the trimmed content is empty,\n    // normalize to a single space.\n\n    if (trimmedText === '' && this.wrapper !== 'pre') {\n      text = ' ';\n    }\n\n    if (this.wrapper !== 'pre') {\n      // Trim leading line feed, which is invisible in HTML\n      text = text.replace(REGEX_LEADING_LF, ''); // Can't use empty string because MSWord\n\n      text = text.replace(REGEX_LF, SPACE);\n    }\n\n    this._appendText(text, style);\n  };\n\n  _proto._addBreakNode = function _addBreakNode(node, style) {\n    if (!isHTMLBRElement(node)) {\n      return;\n    }\n\n    this._appendText('\\n', style);\n  }\n  /**\n   * Add the content of an HTML img node to the internal state\n   */\n  ;\n\n  _proto._addImgNode = function _addImgNode(node, style) {\n    if (!isHTMLImageElement(node)) {\n      return;\n    }\n\n    var image = node;\n    var entityConfig = {};\n    imgAttr.forEach(function (attr) {\n      var imageAttribute = image.getAttribute(attr);\n\n      if (imageAttribute) {\n        entityConfig[attr] = imageAttribute;\n      }\n    }); // TODO: T15530363 update this when we remove DraftEntity entirely\n\n    this.currentEntity = this.entityMap.__create('IMAGE', 'IMMUTABLE', entityConfig); // The child text node cannot just have a space or return as content (since\n    // we strip those out), unless the image is for presentation only.\n    // See https://github.com/facebook/draft-js/issues/231 for some context.\n\n    if (gkx('draftjs_fix_paste_for_img')) {\n      if (image.getAttribute('role') !== 'presentation') {\n        this._appendText(\"\\uD83D\\uDCF7\", style);\n      }\n    } else {\n      this._appendText(\"\\uD83D\\uDCF7\", style);\n    }\n\n    this.currentEntity = null;\n  }\n  /**\n   * Add the content of an HTML 'a' node to the internal state. Child nodes\n   * (if any) are converted to Block Configs and appended to the provided\n   * blockConfig array.\n   */\n  ;\n\n  _proto._addAnchorNode = function _addAnchorNode(node, blockConfigs, style) {\n    // The check has already been made by isValidAnchor but\n    // we have to do it again to keep flow happy.\n    if (!isHTMLAnchorElement(node)) {\n      return;\n    }\n\n    var anchor = node;\n    var entityConfig = {};\n    anchorAttr.forEach(function (attr) {\n      var anchorAttribute = anchor.getAttribute(attr);\n\n      if (anchorAttribute) {\n        entityConfig[attr] = anchorAttribute;\n      }\n    });\n    entityConfig.url = new URI(anchor.href).toString(); // TODO: T15530363 update this when we remove DraftEntity completely\n\n    this.currentEntity = this.entityMap.__create('LINK', 'MUTABLE', entityConfig || {});\n    blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), style));\n    this.currentEntity = null;\n  }\n  /**\n   * Walk the BlockConfig tree, compute parent/children/siblings,\n   * and generate the corresponding ContentBlockNode\n   */\n  ;\n\n  _proto._toContentBlocks = function _toContentBlocks(blockConfigs) {\n    var parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var l = blockConfigs.length - 1;\n\n    for (var i = 0; i <= l; i++) {\n      var config = blockConfigs[i];\n      config.parent = parent;\n      config.prevSibling = i > 0 ? blockConfigs[i - 1].key : null;\n      config.nextSibling = i < l ? blockConfigs[i + 1].key : null;\n      config.children = List(config.childConfigs.map(function (child) {\n        return child.key;\n      }));\n      this.contentBlocks.push(new ContentBlockNode(_objectSpread({}, config)));\n\n      this._toContentBlocks(config.childConfigs, config.key);\n    }\n  }\n  /**\n   * Remove 'useless' container nodes from the block config hierarchy, by\n   * replacing them with their children.\n   */\n  ;\n\n  _proto._hoistContainersInBlockConfigs = function _hoistContainersInBlockConfigs(blockConfigs) {\n    var _this = this;\n\n    var hoisted = List(blockConfigs).flatMap(function (blockConfig) {\n      // Don't mess with useful blocks\n      if (blockConfig.type !== 'unstyled' || blockConfig.text !== '') {\n        return [blockConfig];\n      }\n\n      return _this._hoistContainersInBlockConfigs(blockConfig.childConfigs);\n    });\n    return hoisted;\n  } // ***********************************************************************\n  // The two methods below are used for backward compatibility when\n  // experimentalTreeDataSupport is disabled.\n\n  /**\n   * Same as _toContentBlocks but replaces nested blocks by their\n   * text content.\n   */\n  ;\n\n  _proto._toFlatContentBlocks = function _toFlatContentBlocks(blockConfigs) {\n    var _this2 = this;\n\n    var cleanConfigs = this._hoistContainersInBlockConfigs(blockConfigs);\n\n    cleanConfigs.forEach(function (config) {\n      var _this2$_extractTextFr = _this2._extractTextFromBlockConfigs(config.childConfigs),\n          text = _this2$_extractTextFr.text,\n          characterList = _this2$_extractTextFr.characterList;\n\n      _this2.contentBlocks.push(new ContentBlock(_objectSpread({}, config, {\n        text: config.text + text,\n        characterList: config.characterList.concat(characterList)\n      })));\n    });\n  }\n  /**\n   * Extract the text and the associated inline styles form an\n   * array of content block configs.\n   */\n  ;\n\n  _proto._extractTextFromBlockConfigs = function _extractTextFromBlockConfigs(blockConfigs) {\n    var l = blockConfigs.length - 1;\n    var text = '';\n    var characterList = List();\n\n    for (var i = 0; i <= l; i++) {\n      var config = blockConfigs[i];\n      text += config.text;\n      characterList = characterList.concat(config.characterList);\n\n      if (text !== '' && config.type !== 'unstyled') {\n        text += '\\n';\n        characterList = characterList.push(characterList.last());\n      }\n\n      var children = this._extractTextFromBlockConfigs(config.childConfigs);\n\n      text += children.text;\n      characterList = characterList.concat(children.characterList);\n    }\n\n    return {\n      text: text,\n      characterList: characterList\n    };\n  };\n\n  return ContentBlocksBuilder;\n}();\n/**\n * Converts an HTML string to an array of ContentBlocks and an EntityMap\n * suitable to initialize the internal state of a Draftjs component.\n */\n\n\nvar convertFromHTMLToContentBlocks = function convertFromHTMLToContentBlocks(html) {\n  var DOMBuilder = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getSafeBodyFromHTML;\n  var blockRenderMap = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : DefaultDraftBlockRenderMap;\n  // Be ABSOLUTELY SURE that the dom builder you pass here won't execute\n  // arbitrary code in whatever environment you're running this in. For an\n  // example of how we try to do this in-browser, see getSafeBodyFromHTML.\n  // Remove funky characters from the HTML string\n  html = html.trim().replace(REGEX_CR, '').replace(REGEX_NBSP, SPACE).replace(REGEX_CARRIAGE, '').replace(REGEX_ZWS, ''); // Build a DOM tree out of the HTML string\n\n  var safeBody = DOMBuilder(html);\n\n  if (!safeBody) {\n    return null;\n  } // Build a BlockTypeMap out of the BlockRenderMap\n\n\n  var blockTypeMap = buildBlockTypeMap(blockRenderMap); // Select the proper block type for the cases where the blockRenderMap\n  // uses multiple block types for the same html tag.\n\n  var disambiguate = function disambiguate(tag, wrapper) {\n    if (tag === 'li') {\n      return wrapper === 'ol' ? 'ordered-list-item' : 'unordered-list-item';\n    }\n\n    return null;\n  };\n\n  return new ContentBlocksBuilder(blockTypeMap, disambiguate).addDOMNode(safeBody).getContentBlocks();\n};\n\nmodule.exports = convertFromHTMLToContentBlocks;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}